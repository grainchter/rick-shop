{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\rick-shop\\\\rick-shop\\\\src\\\\mobile\\\\basket\\\\basket.js\",\n    _s = $RefreshSig$();\n\nimport s from './basket.module.css';\nimport { useEffect, useState } from 'react';\nimport { useSelector } from \"react-redux\";\nimport { database } from '../../firebase/firebase';\nimport { getUserToken } from '../../store/user';\nimport Preloader from '../../components/main/preloader/preloader';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst BasketMobile = () => {\n  _s();\n\n  let userId = useSelector(getUserToken);\n  const [loaded, setLoaded] = useState(false);\n  const [data, setData] = useState({});\n  const [array, setArr] = useState([]);\n  const [isLoading, setLoading] = useState(false);\n  useEffect(() => {\n    if (loaded) return;\n    setLoaded(true);\n    setTimeout(() => {\n      getData();\n    }, 1000);\n  });\n\n  const getData = () => {\n    if (Object.keys(userId).length > 0) {\n      database.ref('/users/' + userId + '/basket/').once('value', snapshot => {\n        const db = snapshot.val();\n\n        if (db != null) {\n          setData(Object.entries(db));\n          setLoading(true);\n        }\n      });\n    } else {\n      if (JSON.parse(localStorage.getItem(\"data2\")) != null) {\n        setData(JSON.parse(localStorage.getItem(\"data2\")));\n        setLoading(true);\n      }\n    }\n  };\n\n  const check = id => {\n    let checked = false;\n\n    if (document.getElementById(id).checked === true) {\n      document.getElementById(id).checked = checked;\n      setArr(array.filter(item => item !== id));\n    } else if (document.getElementById(id).checked === false) {\n      document.getElementById(id).checked = !checked;\n      setArr([id].concat(array));\n    }\n  };\n\n  const del = () => {\n    if (Object.keys(userId).length == 0) {\n      for (let i = 0; i <= array.length - 1; i++) {\n        let items = JSON.parse(localStorage.getItem(\"data2\"));\n        items = items.filter(item => item[1].id !== array[i]);\n        localStorage.setItem(\"data2\", JSON.stringify(items));\n      }\n    } else {\n      for (let i = 0; i <= array.length - 1; i++) {\n        database.ref('/users/' + userId + '/basket/' + array[i]).remove();\n      }\n    }\n\n    window.location.reload();\n  };\n\n  const buy = () => {\n    if (Object.keys(userId).length == 0) {\n      console.log(\"Зарегайся сначала\");\n    } else {\n      for (let i = 0; i <= array.length; i++) {\n        for (let j = 0; j <= data.length - 1; j++) {\n          if (array[i] == data[j][1].id) {\n            data[j][1].process = \"accepted for work\";\n            console.log(data[j][1]);\n            database.ref('/users/' + userId + '/orders/' + data[j][1].name + data[j][1].id).set(data[j][1]);\n          }\n        }\n\n        database.ref('/users/' + userId + '/basket/' + array[i]).remove(); // console.log(array[i]);\n      }\n    }\n\n    window.location.reload();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: isLoading === false && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Preloader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }, this)\n  }, void 0, false);\n};\n\n_s(BasketMobile, \"kTIXihPHxc37TW+z1r9uhAzH4A8=\", false, function () {\n  return [useSelector];\n});\n\n_c = BasketMobile;\nexport default BasketMobile;\n\nvar _c;\n\n$RefreshReg$(_c, \"BasketMobile\");","map":{"version":3,"sources":["C:/Users/user/rick-shop/rick-shop/src/mobile/basket/basket.js"],"names":["s","useEffect","useState","useSelector","database","getUserToken","Preloader","BasketMobile","userId","loaded","setLoaded","data","setData","array","setArr","isLoading","setLoading","setTimeout","getData","Object","keys","length","ref","once","snapshot","db","val","entries","JSON","parse","localStorage","getItem","check","id","checked","document","getElementById","filter","item","concat","del","i","items","setItem","stringify","remove","window","location","reload","buy","console","log","j","process","name","set"],"mappings":"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","sourcesContent":["\r\nimport s from './basket.module.css';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useSelector } from \"react-redux\";\r\n\r\nimport { database } from '../../firebase/firebase';\r\nimport { getUserToken } from '../../store/user';\r\nimport Preloader from '../../components/main/preloader/preloader';\r\n\r\n\r\nconst BasketMobile = () => {\r\n\r\n\r\n    let userId = useSelector(getUserToken);\r\n\r\n    const [loaded, setLoaded] = useState(false);\r\n\r\n    const [data, setData] = useState({});\r\n\r\n    const [array, setArr] = useState([]);\r\n    const [isLoading, setLoading] = useState(false);\r\n\r\n\r\n    useEffect(() => {\r\n        if (loaded) return;\r\n        setLoaded(true);\r\n\r\n        setTimeout(() => {\r\n            getData();\r\n        }, 1000);\r\n\r\n    })\r\n\r\n    const getData = () => {\r\n\r\n        if (Object.keys(userId).length > 0) {\r\n            database.ref('/users/' + userId + '/basket/').once('value', (snapshot) => {\r\n                const db = snapshot.val();\r\n                if (db != null) {\r\n                    setData(Object.entries(db));\r\n                    setLoading(true);\r\n                }\r\n            });\r\n        } else {\r\n            if (JSON.parse(localStorage.getItem(\"data2\")) != null) {\r\n                setData(JSON.parse(localStorage.getItem(\"data2\")));\r\n                setLoading(true);\r\n            }\r\n        }\r\n    }\r\n\r\n    const check = (id) => {\r\n        let checked = false;\r\n        if (document.getElementById(id).checked === true) {\r\n            document.getElementById(id).checked = checked;\r\n            setArr(array.filter(item => item !== id));\r\n\r\n        } else if (document.getElementById(id).checked === false) {\r\n            document.getElementById(id).checked = !checked;\r\n            setArr([id].concat(array));\r\n        }\r\n    }\r\n\r\n\r\n    const del = () => {\r\n\r\n        if (Object.keys(userId).length == 0) {\r\n            for (let i = 0; i <= array.length - 1; i++) {\r\n                let items = JSON.parse(localStorage.getItem(\"data2\"));\r\n                items = items.filter((item) => item[1].id !== array[i]);\r\n                localStorage.setItem(\"data2\", JSON.stringify(items));\r\n            }\r\n        } else {\r\n            for (let i = 0; i <= array.length - 1; i++) {\r\n                database.ref('/users/' + userId + '/basket/' + array[i]).remove();\r\n            }\r\n        }\r\n\r\n        window.location.reload();\r\n\r\n    }\r\n\r\n    const buy = () => {\r\n        if (Object.keys(userId).length == 0) {\r\n            console.log(\"Зарегайся сначала\");\r\n        } else {\r\n            for (let i = 0; i <= array.length; i++) {\r\n                for (let j = 0; j <= data.length - 1; j++) {\r\n                    if (array[i] == data[j][1].id) {\r\n                        data[j][1].process = \"accepted for work\";\r\n                        console.log(data[j][1]);\r\n                        database.ref('/users/' + userId + '/orders/' + data[j][1].name + data[j][1].id).set(data[j][1]);\r\n                    }\r\n                }\r\n                database.ref('/users/' + userId + '/basket/' + array[i]).remove();\r\n                // console.log(array[i]);\r\n\r\n            }\r\n        }\r\n\r\n        window.location.reload();\r\n\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {/* {\r\n                (isLoading === true) &&\r\n                <div className={s.container}>\r\n\r\n                    {\r\n                        Object.values(data).map(([key, { name, id, image, species, status, price }]) =>\r\n                            <div className={s.wrapper} onClick={() => {\r\n\r\n                                check(id);\r\n\r\n                            }\r\n                            }>\r\n\r\n                                <div className={s.checkbox}>\r\n                                    <input type=\"checkbox\" id={id} />\r\n                                </div>\r\n\r\n                                <div className={s.text}>\r\n                                    <p>{name}</p>\r\n                                    <p>{status}</p>\r\n                                    <p>{species}</p>\r\n                                    <h1>${price}</h1>\r\n                                </div>\r\n                                <div className={s.img}>\r\n                                    <img src={image}></img>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    }\r\n\r\n                    <div className={s.buy}>\r\n                        <h1>Купить сейчас</h1>\r\n                        <button onClick={() => {\r\n\r\n                            buy();\r\n\r\n                        }}>Buy</button>\r\n                        <button onClick={() => {\r\n\r\n                            del();\r\n\r\n                        }}>Clear</button>\r\n                    </div>\r\n\r\n\r\n                </div>\r\n            } */}\r\n\r\n            {(isLoading === false) &&\r\n                <div>\r\n                    <Preloader />\r\n                </div>\r\n            }\r\n\r\n        </>\r\n    );\r\n}\r\n\r\nexport default BasketMobile;\r\n"]},"metadata":{},"sourceType":"module"}